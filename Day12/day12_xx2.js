let input = `.???#??????#. 6,1
???##???##?#??#?#..# 1,14,1
#??????#????#?###?# 3,1,10,1
.???????#????. 1,2,1,2
?##?.??.???.. 3,2,2
#.?###?#??. 1,5
?#??#??????????.??.? 7,2,3,1
???###?#.##??? 8,3
.##???.?????? 2,1,2
???.?????????? 1,5,2
???#????#? 4,1,1
.????.#.???. 2,1,2
.????.?.??##?? 1,1,1,5
??????##?#? 6,1
?#????#?#?.?#???? 1,2,2,3
#..??????????????. 1,1,2,7
????????#?. 1,2,4
##??.??.??#?#? 3,4
????#???????##?.??.? 2,1,1,5,1,1
.?#?????#???..#???? 4,1,1,1,1,1
?#?????#.#???? 6,1,1,2
????#?.????? 1,1,2,1
.??#?.#??. 2,3
?.?#????.???#####??? 1,5,9
??.#?#?#??#? 1,8
?.???.??.?? 1,1,1
????.?.#.? 1,1,1
??#???????#?.#??# 3,3,1,2,1
??#???.??????.? 4,4,1
#??#??..??????. 4,1,1,1,1
?????.#??. 1,1,1
.???#.??#???.? 1,1,4,1
??##???#..???? 3,2,1
????..???###?# 1,1,7
.??.?.##?#..?.?? 1,4,1,2
?????#?#???##??#???. 3,14
?#??????#?? 4,2
?.?#??#??? 2,5
??#?#???????## 1,1,1,7
??#?.###??#? 1,6
#???????#?.#?#? 5,1,4
#??.???#???.?## 3,1,5,2
???#????????#??? 4,6
.#????#??????.?? 3,4,1,1
?.???.?#?????#? 2,5
?.???..#?.?. 1,2,1,1
???.#????#????#? 1,1,8
??????????#.?.?.??? 2,7,1,1,1,1
#??##??#???? 1,7,1
??#?.??#??????? 3,5,3
??###???????#.#? 10,1,1
??#.??.??????#?.?? 2,2,3,2,1
??#??????.??.????? 8,3
?..#?#???#?? 1,4,1,1
.?.?#?????#??#? 1,1,1,1,4
????#?.#??? 4,2,1
?.???###?.? 6,1
??.???????..???. 4,2,2
????.#????.#. 3,4,1
????.????.?#?#??? 2,1,1,5
#???????.?#?#.. 3,1,1,1,1
.??.??????.#? 5,1
.?????#.???.##?? 5,1,2
####????#?????#??.# 5,10,1
?????.???#.???.?#. 3,1,2,1,1,1
#?#????#????#? 8,4
?#?.????????.??# 2,6,1,1
???????.???.???? 2,1,1,3
#???#?#???????? 5,1,1,4
?.#??????..???#???? 7,6
.??????#??# 1,1,4
????????????????? 5,1,1
??????#????????????? 15,1
?#?????#?# 3,3,1
?????#.###???# 1,1,4,2
?#?????.??? 6,1
?.???.??#??#?#?? 1,9
?#?.??????#?? 1,2,3
??#?????????#???.?# 3,3,2,1,1
?##???.?.?#????. 5,5
?.????#?###????? 1,7,1
????.????##???? 4,3,1
??#.?????###??. 1,1,2,1,5
.???...??. 1,1
#?.?#####???#?.#?? 1,11,1
.???????#?.??? 7,1
.????.????# 3,2,2
#????#???.??#? 3,4,1,1
?#??..?#??. 3,3
.??.????##??##???? 1,10
#.#???#?###??.#??#.? 1,1,8,4,1
???????#????????#?#? 9,6
#.?.??????.?????#? 1,1,1,1,3,1
..#?...?#???###.. 1,7
.?.??#????#? 1,2,4
..#.#.????????#?#? 1,1,1,1,1,2
?##?#.?#.? 4,1
?.#?#?#??#??.??? 1,1,4,1,1
.?.?#?#???#??.??# 1,9,1,1
.#?????????##?? 3,7
.??????.?. 1,1,1
.?#????###??#???##. 12,1,2
.????.???.??#?#???#? 1,1,9
?.???#???#.??? 8,2
??.?#..???. 1,1
????##???#??###??.?? 16,1
??.??..#????? 2,4,1
?.???.??????? 3,6
??.???.?#?#?????? 1,1,1,4,4
?#????.????.?#?#.? 3,1,1,2,3,1
..?????#?.#?#?#.??. 1,1,1,1,3,1
??#?#?#????????.???? 11,1,3
?????.?????? 1,1
..??#??##???.??#??.. 6,3
?????.###?.?#???.?#? 3,3,3,3
???.??#####????#?. 1,7,2
??????#???.???.???? 8,1,1,1,1
??????.??.?????.? 5,1,1,1
..???????? 1,1
?.#??..????#?#??? 1,1,1,3,4
.?????????#. 1,1,1,1
???#??##?#?.. 7,1
?.?####???.??##? 5,3
#???#?????..???? 1,3,4,4
#?.???.??.?#??? 2,2,2,3
?#?#????????.?#????? 9,1,6
##??.#.?..?##?#??? 2,1,7
??#?#.????.??..?.?# 5,1,1,1,1,2
?.?#??###?????????? 1,7,8
#.?#.????? 1,2,3
?.???#?#?.?#.?. 3,2
??????##?#??#??.?? 1,10,1,1
?.?#?#?#??####???? 1,11,1,1
#.????????##.#???? 1,8,1,1,1
???#.???.??????#? 4,1,5
?#?????###?.? 5,3,1
..??????.?. 3,1
#????#.?????.#?... 1,1,1,2,1,2
??#.?????#??? 1,1,1,5
???..????? 1,1,1
??#?????#??... 4,3
?.#???#??# 1,1,5
???#???????##?#?? 1,2,2,1,5
??????#????#??#. 1,4,2,1,1
???#??.????? 3,2
.##?#?#???#?# 8,3
?.#?...??##?????#?.. 1,1,10
????#.?.#? 3,1,1
??#?#?.?#.#??#?? 2,2,1,6
.#???..?#####? 1,1,6
#???????#???#?#.. 1,7,2,1
.?#???.???##??#???? 3,1,1,7,1
???#.?????#? 1,1,1,1
???.??######?????. 1,11
#..???.???? 1,2,1
??????#??.????#? 2,5,1,3
#?.?.?.?????.? 2,1,2,1
??#.???.???.? 2,2,1
?#?????#?#?????????? 3,13
?????????#??.?.? 1,1,3
##?##???..??.??# 6,1,3
??#?.???.?. 1,2
??.#??#???##??. 1,1,1,5
.??#?????#?..# 7,1,1
???.??.???????? 2,1,1,1,1
#?.?#?##?????? 1,9
????#???#??.??????? 11,1,2
??#?????#??#.###?# 10,5
?#..????????? 2,3,2
.#?.????????.??.? 1,4,2
?###?.##?##.#?.???.? 5,2,2,1,2,1
??#???????#??#????# 1,1,1,1,8,1
??.??????#? 1,1,2
???.??#.??.????.??? 1,1,2,1,4,1
???.#.???????# 1,1,8
??.??#.??#..? 2,3,3,1
?.?#??.##?##? 3,5
#.???????.?? 1,2,3,2
###?.?#??#? 4,5
?#?#.?#?## 3,5
???????????? 2,2,4
?.?????#??#???? 1,3,1,1,1
???##?#?.?#.??# 8,1,1
#??#?.?... 2,2
???#??????#????.??? 4,6,1,2
??.?#.????#. 1,1,1,1
.??????#?.#?????. 2,5,1,1,1
?????#??.?###?##.?#? 2,5,6,1
#.?????.?.????????. 1,2,1,1,5
.??#?????????#???. 3,5,4
??#?.??###????#??#.? 1,13
??##??.?.#?.?#?? 5,1,1,1,1
..??..???#??#? 1,6
?????????. 1,2,2
?#??????#????????? 1,3,1,1,1,1
??#.?.??????##?? 1,1,3,3
?##????##????? 4,4,2
???##????.?????. 5,2
??#????#????? 6,1
????????????????#??? 5,2,2,3,1,1
???????#????#???? 4,2,1,1,2
.?##?#?###?.?? 9,1
??#??????.#?? 1,1,4,1
????##???.? 6,1
?##?.?#?##?? 2,6
..???.???.##.? 3,1,2
.??##??.?#?? 4,2
?.???????.?#???? 3,3,3
??????##?????# 1,6,2
????#?#??#.????#.?#? 6,1,2,1,2
??.#??????? 1,7
.#????????? 5,1,1
?.???##?#??????.? 1,10
??#?#?.?.????????? 3,7
??#???.?#?#????.???? 1,4,2,1,3,3
??#????.???#? 5,4
?????????? 1,2
??.#.??.??? 1,1,2
?.???..??.#. 1,2,2,1
?#???##???#?#??# 6,1,1,2,1
???.???.?#. 2,1
?.???###?#?# 1,3,1,1
??#?????....??#..??. 6,3
.?.?????.?#???? 1,1,4
?#?..##???#.????#? 2,2,2,2,2
.???#?#??.????? 6,1,2
???#?.#.?#? 3,1,1
???.??????#???#????? 3,1,3,1,1,1
.?????..????? 1,2,2,1
#????#?#???# 1,1,7
???#??#????#???##??? 7,10
????###?#??? 4,4
..?#?#?.??# 3,2
?#.?#?#?????.. 2,5,1
????????#?###?# 2,3,1,5
??????????.#????#?# 1,1,2,1,6,1
???.???##???# 2,6
##?.????#????#???? 3,2,1,1,1
?.???#??.?. 1,6,1
?#???.?#.#?#??#? 5,2,1,4
.#?#??.?????#???. 3,7
?#.?#?#..? 1,4
.???###??#?#?????#?? 7,11
#?.?#???#??##??##?## 1,2,1,2,6
#??#????#???.# 2,4,3,1
.?##?????#?.#?#?? 3,1,4
.?.??#??.?#??????# 1,3,1,2,3,1
???.??##??#.???? 1,1,5,1
?#?#?..?.#?# 5,1,1
.???#?.##???. 3,4
??#?.?##???? 2,2,1
??#?##?.????.?#?? 7,1,1,4
.??????#.#????#?.?# 2,4,1,1,1,1
?.??????##?? 2,1,4
???##???#????? 9,3
#???#??#?.? 1,5
...????##??.? 5,1
.#?.?.?????##?#. 2,1,3,3,1
.##..??#??#?##. 2,4,2
#??#?.?#.?#???#?##?? 1,1,2,1,2,4
???.?#??????? 1,2,1,2
#??.???..??????#? 1,2,8
????.?#?.?? 1,3
?###.##??. 3,3
??#???.????.????. 2,1,3,1,2
.???##?.??#??? 3,2
.?????????. 3,1,2
#???????.?#??????# 3,1,1,3,3,1
.???.#????#?#?? 1,1,8,1
????????#??##? 1,5,3
?#???#?#.#?.??#?.?? 7,2,3,1
???#???#????#?? 3,4,1
.?.?###???.. 4,1
.#?##??????..? 4,5
.????#??????? 2,1,1,2
?.?.?????..?.. 1,5,1
.????.?#???#?????# 3,5,3
?.???#?#??? 1,2,1
?.?.?????????????? 1,1,1,5,1,1
?????????. 1,2
#?##.??##???#?. 4,1,7
???.????#.? 2,2
?????.?????? 1,2,1,2
??..?#???? 1,2,2
?????#????.?#??????. 1,1,1,3,3,1
?????##???? 3,5
?????????#?? 2,3,1
###?.?#???.?? 4,1,2,2
????.????#?????#??#? 3,1,3,1,1,2
??#?##??..?. 1,6
??#?.?#?????.???. 4,4,1,2
??????..#?##??.?#? 3,1,5,1
???#..?????? 4,2,1
#???#????????#??? 2,2,8,1
?.#???#????.? 5,2
??.???.##??? 1,4
?.#??.??????.? 1,1,5,1
??#??#??#??.???? 9,1
.???#?#?#?.????? 8,2
?##.??????? 3,1,4
?..??#?#?????? 7,1
??.???????##?#?? 1,3,8
?.?##?.?#??.# 1,2,2,1
#?.?.?##?#?. 1,1,6
??????#????..?. 3,6
???##.?.?.#??#?##? 3,1,1,5
???????###??. 1,1,6
????#???#???###??? 9,3
..?????.?.???# 1,3,1,4
?#?????.?#?.?#.??? 2,2,1,2,1,1
.??????.?????#?. 1,6
.??.#???????#?? 1,1,5,1
##???.?#?# 3,1,3
.???????.??#? 2,3,3
?#####????#???? 6,4,1
#???#..#?? 5,1,1
?.###??#.??#???? 6,4
?###??.?????.??? 5,3,1,1
?#?#???#.??.????.??? 1,5,2,1,1,3
????#??#??##??? 1,10
??#?#?.??##??????? 2,1,8
.??.??##?? 2,5
?.??#???????# 1,2,2,1
..#?.???#????? 1,9
???#????.?.?.#.?.? 5,1,1,1,1,1
.?.?#?????????.?.#? 1,6,1,1,2
?.#?#...?. 3,1
#?????.??? 6,2
??.?????????? 1,3
.?##??#??#??.??????? 10,2,1
??#.???#???.? 3,2
?.####??????#?.#??? 1,5,1,1,1,1
?##?#?##????????. 11,1
?#????????? 2,1,4
???#??.????? 5,1
???.#??????#??? 2,2,2,3
??..???#?#.????#? 1,1,1,1,5
????.?.???#??.# 1,1,2,1
###.???.???# 3,2,1
.?????.??#?? 4,3
???#?.???..????#?.? 2,3
????#.#?#? 1,1,4
??#?#..??.# 4,1,1
..#?.????? 1,2
?#..????.? 1,4,1
?.?#???##????#???.? 2,7
###????????? 3,3,1
???#.?#???#?. 3,6
??#??.#????#? 3,2,1
???.?#??#?? 2,2
?.??..#???#?????. 1,1,7,1
?.????#??? 2,3
????.????#.? 3,3,1,1
.?..#??????##??.?. 4,5
???????#??.? 8,1
#?..?.??#?.?? 1,3,1
???????...??#???#?? 2,3,1,1,2,1
??.??????##??.?? 1,4
?????#??##?.##???? 9,2
?##?#????#.#.??? 2,2,2,1,2
????###?##??.????? 10,3
??#...?#.# 1,1,1
?#????#.?????#?#??? 2,1,1,8,1
.??#??.?.?#?#.?.#??? 2,1,3,1,2
.???#.?.#??? 4,1
.???.???#?##?##?#..? 1,2,9,1
?#??#####????????#?? 10,3,4
#?#???#?.?#?? 3,1,2
???#????##????#. 11,2
.???.##??? 3,5
#??#?##??????..?#? 8,1,2
???.?##????#?#?.??# 1,1,8,1,1,1
???#??????..??? 1,5,2,1,1
???#?.?????#. 1,4,1
??#?.??#?#?##???? 2,5,3,1
??????#?????#??? 1,1,9
???.??#????#?#? 2,1,1,4,2
###?????.. 5,1
?.??#...??.?? 2,1
????????##?#?.???? 1,3,6,1
??###?.??.??.??#??. 4,4
?.?.?#.??.? 2,1,1
#.???##.###?. 1,5,4
..?###?#?#??#??.?.? 4,3,3,1
#?.?.?#?#??.?#. 1,1,1,2,1
.???#??#.#?? 1,3,1,1
.????????#??????#?. 11,1
?#?#?????# 4,1,1
?????????.?#? 1,3,1,2
??#?????#??#?????##? 3,1,3,4,3
??#???.??##.???# 4,4,3
??????????. 2,4,1
?#???#.#..??#.? 6,1,1
??#.?????#????.##? 1,1,1,2,1,2
.??#????##?.#??.?# 8,3,1
.?????#??#??.??.?#? 2,2,2,2,3
?#??#???#????? 1,9
.?.??#?##??? 6,1
??????????????# 1,1,1,1,3
?##??##??## 7,2
#.#?#???#?.. 1,3,2
.???#..?#??#?? 1,1,2,2
?#?####????#. 7,1
.??????.#??. 2,1,3
???#?.?##??.?? 5,2,1,2
?.?#????#??????#??? 1,1,3,2,4
#?.?.?????##.?#??? 1,7,5
???#??.?#?##??#? 3,8
####??..#?.??. 4,1,1,2
.?.?????#?#?????#? 1,1,12
?..??????#? 1,1
?##..????.#?#??. 2,2,1,3
.???.?.??. 1,1
#??#?#?#?#???.??# 10,1,1,1
..?.????.? 3,1
.???#?????..????? 6,3
#?#?..##?#.???.???? 4,4,1,1,1
.#?#?.?##???.#.?? 1,1,6,1,1
?..???##???#???. 1,5,4
.##.?###??.???#?. 2,5,5
???.??????#?????.##. 1,1,7,1,1,2
??.?#.?#???###?????? 2,8,3
#?#???.?#.?????#.? 4,1,2,2
???.???????# 1,2,1,1
?.??.?#???#????#??# 1,11,1
??#??#?#?#??????#?#? 14,4
?#???????#? 1,6
???.??##??####?.??? 1,9,1
????????.??#. 2,3
??##??#?.??? 2,2,1
.?#??##.#? 3,2,1
#?##?????## 1,4,3
.????.#?#??#?. 2,1,1,2
.??????#?##?##.?? 2,1,7,1
?.#????.??.??...?? 3,1
#??#?????.#?.?? 1,7,2,1
??#????????#?# 1,5,1,3
?.??.#???? 1,3
???##?.???????? 2,7
#.???#????###??#?? 1,6,4,1
.???..??????#?????? 1,1,3,8
?.??.???#? 1,4
?.??.?#????# 1,1,1,3
#????#???? 1,1,5
???.#??#?#?????????. 1,1,2,6,1,1
..#?.#?#??#?? 2,1,1,1
??##???.??#??? 3,1,1,1
?###??????#?# 5,1,3
#??#??#?.???##..? 2,2,1,1,2
.??#??.??..?# 3,1,2
.???.??#???#?.??.#? 2,5,1,1,2
?#???.??.???????#? 4,2,8
#.#???????#?????.?? 1,1,1,5,2,1
?##?.##???? 3,2,2
???.#.?????# 2,1,4,1
.??.???####??.#.???? 1,9,1,1,2
?#???#???#???. 3,5,2
.?.?.????????#? 1,1,6
???#??????..??# 8,1,2
????????.?#??#?.? 7,1,2,1
#?#?????..?.##?#? 4,1,1,2,1
#?????????? 4,4
????.?#?????#? 2,7
??#.????.? 1,2
#?????#?#?????.?? 1,1,4,2,1
?##?#???.?###? 2,3,4
??##.????#??? 3,1,1,4
??.??#?#.?.?? 2,1,1,1
?.?????#?? 1,1
?.??????##?????..??. 1,1,1,7,1
?##??#?.#???#??? 6,1,5
??????#####??#? 1,8,1
.?###?##..????????.? 7,6,1
??#???.???????...??. 4,1,7
.?#.?.?#?#??##?? 1,7
??.#?##?????????#.. 1,1,9,1
??????#??.??. 7,1
.?#?#?##??#????# 8,6
??????.?.???#??????? 3,3
??????#?..#. 3,3,1
??#?#???.?#.?# 7,1,1
???.?.????#??##???? 1,9
????##?.??????# 6,2,4
?.?.?.#?##? 1,5
??.???#.#??####???. 2,1,7,2
?#??#??##.???????? 2,6,1,1,1,1
#?????..?????##? 1,1,1,1,3
#?#?#????#?#? 1,1,3,4
..?##???#??###??..# 13,1
.??#??.#?#?.????..? 1,3,1,2,1,1
?.?.??#?#.???#?.? 1,1,4,1,2
???.#.#????? 2,1,2,3
??????##?.??.?.##?? 1,1,4,2,1,4
??###??.???.?? 6,1,1
????????#.?????? 1,1,2,1,6
??..?????. 1,4
?????#?#??# 1,3,1
??#???#????? 2,1,4
???..?#???#.####?#?? 2,6,8
?#???.????.?.#?#??? 3,1,1,1,4,1
??####????????.#.? 6,4,1
??#?#????.?????????? 8,7
.????#?..?##?.?? 1,2,4
#?#..#????.?.?.? 3,5,1,1
???.???#?? 2,2
.??.###?##?#??????#? 1,12,2
??.#???.?? 1,3,1
??##????#????????. 3,9
???????#??#??.? 1,1,2,1,1
????#??.?# 2,1
?.????.#????# 1,1,1,4
??#???????.#.?.??#?? 6,1,1,1,1,1
??#?.###??#.???? 4,3,2,2
?#???.????#?#?#???? 3,1,9
?.??.##??#??#?.??? 1,2,3,5,2
?????.????????##? 3,3,4
??.??????. 1,2,1
....#???.?#?. 3,1
.??#????#.??#.?#??? 1,2,3,1,5
???#?###??.?.#.?.?? 8,1,1,1
??.???#??##? 2,1,1,2
???????#?#???? 2,7
????#??#???##??.?? 2,1,3,5,1
???.???#####???#??? 1,7,4,1
???????###??# 1,6
?????#???## 6,2
#????.???????? 3,1,2,4
?#??#?????#.??????# 2,2,2,1,3
.?.?#?#?#.?????????. 5,3
??#??##??????#?.. 6,1,5
??.????????#? 1,8
??.????##? 2,6
?????.?.?? 3,1
?????????#?#. 1,2,1,3
?.??##.#.# 3,1,1
?##??.?..#??? 2,1,1,1
?????.?????#??? 2,7
??#???#...????# 4,1,1,1,1
??????#.??#??##?? 1,1,1,6
??.?#????????? 1,1,5
?.???#??.# 6,1
???#?#?.?????. 1,4,5
.????.?#??? 1,2,4
??.#??????? 1,1,5
??????.?????? 2,1,4
#?#??##??##???? 3,7,2
?###???##?#??? 8,1,1
?#?????#???.????#?? 2,7,5
????#?#?.?.????? 4,1,1,1,1
???.#.?#?#?? 1,1,1,2
?.?#??#..?#?.?#?#? 2,2,2,4
#????#..??? 2,3,3
?##?????.??#??#.? 3,1,1,6,1
????.#??#?####??? 1,1,1,7,1
.???????#????#? 5,1,2
??#.???#?#?.. 2,4
????#???.????#?##? 4,7
.????.??.#?#??.? 4,1,3,1,1
????.#?#.?#?????#? 1,1,1,1,3,4
#????#??.?? 2,2,1
?#????????#??????.? 8,1,1,1,1
.???????#???#? 1,1,4,1
.##?#???????#. 5,1,1
?..??.?.??? 1,1,2
?#???.?.?????????# 5,1,1,1,1,2
.?????#???.??? 3,2,1,1
...??#?????...?????? 4,2
#???????#??????##?? 1,2,5,4
#?..##????#?####? 2,12
.?#.??#????? 1,4
.?????.???.?? 4,2,1
.?.?#.???..??#??#?? 1,1,1,8
???#??#???#??#?..#? 3,9,2
.?#?#???.?????..??. 5,3,1
#.????#??.?????? 1,4,1,3,1
.????.???#? 4,2
???##.???...???##??? 4,3,4
?##???.??##?.. 4,3
??.?#?.??###?##??? 1,2,8
???#???#??. 3,2
?????#?#????????. 2,6,2
.????.???? 3,1
????.??????#????#? 3,7,1,2
#??.????.???? 1,2,1,1
?##??.?.#?.? 4,2
??????#??#?? 2,2,1
????????.???#. 5,2,1,1
.?.#???????#.????. 1,3,3
.??.???.?.?? 1,1,1,1
.?.????#?####????.#? 1,10,1,1
.?????#???#. 2,1,1,1
##.??#???????? 2,4,1,1
???#?..???##???????. 4,7,3
#..??????#? 1,8
?????.???? 3,3
?.##?.#???. 3,1,1
#??????##??# 9,1
.?????#??? 1,3
??.?#??##??#???.? 1,8,1
???###..???#??? 5,4
?.????????.??#??.??? 1,1,6,1,3,1
??????.?#.??#?.?? 5,2,3,1
??????##?#.??####. 2,6,5
?..???#?#?##?#?? 1,9,1
??.??.??#? 1,3
??????#????#?? 1,1,7,1
?????##.???????##?? 2,3,1,2,4
?.?????.?#? 1,2,1
.#?.??#??????.#. 2,7,1
?.?#?#?#?????.????. 9,1
.??.???#??.# 1,6,1
#?#?.??..??#?. 4,2,1,2
???#?.#.?.???##???? 1,1,1,7
..#.?#.????????? 1,1,2
?#..#?###????. 1,8
?#?.?????????? 3,8
?.?#???????##.?.??. 1,1,7,2
#??#????#???#? 11,1
?#.#???#??? 1,1,1
?#??..?#????? 1,1,6
..???#?.??#??? 4,2
????##????? 1,4,1
??.?#???.??#?.???? 1,1,1,4,1
??#?#????? 5,1,1
#????#??#???#?.????? 1,9,2,1,1
???#??#??? 7,1
?##..?.##?? 2,3
???.????????. 3,3,3
.#??.????#?####??##? 1,14
???#?#?#????#. 5,1,3
#???????#??.???#?.?? 3,7,1,2,1
????..???????#??# 1,1,10
?.??????#. 3,1
?.?..????#?### 1,8
..?#?.???? 1,1
??????????##??? 1,1,2,6
.???????.#????.???#. 1,1,1,2,1,4
#???????#??.??#?? 5,1,1,4
?#?#?????? 4,4
?????#?.?????.??###? 3,2,4,4
??#?.?#???? 3,1
.????#.#?#?.??? 1,3,3
#.??.???????#? 1,1,3,1
?.?.???.??##?##?? 1,1,1,6
???#?#???.???? 1,4,2
???.?##??#????????? 2,9,1
.?#??#????.???? 2,2,2,1,1
????.?#???#???.?. 2,3,2,1
?#.???.????? 1,1,1,1
?..?????.?.#?##?#? 3,6
?#.?????#?????? 1,2,1,1,1
..??#??#.? 5,1
.?.??#?.#?#???????.? 3,9
.????????#??#???? 5,3,2
??#....##?? 2,4
?????##????? 7,1
??.???????????#?#? 1,3,1,7
?.?#???????.##?????? 1,6,7
?.?..?????????????? 4,5
???#??.??????#? 5,2,4
?.???##??#.?. 1,5,1
????.????#??# 1,1,2,1
.?##?#???.??.?? 7,1,1
#???.?.??#???? 1,1,1,7
??#?.????? 2,3
?????????. 1,1,2
.??????.?##?##. 2,6
??.?#??.??#?##?# 1,2,7
..???#????#? 2,7
??#??##????? 2,4,1
..?..??.???????.?? 1,3
??.??.????..#??? 1,2,4,2,1
??#???.????##?? 3,1,6
.??????##???.# 8,2,1
#????.###??#.? 1,1,3,1
#?#????????###?#?? 3,10
?#???##.??##.?.?..# 7,3,1,1,1
??????#????#? 2,6,1
??#?....#?# 2,3
?????##?.?. 2,2
??.??.??###.?? 2,1,5,2
#??#??#?#.?..???? 1,7,1,1
??????#??. 1,2,4
#??##??.##? 1,5,2
???#??#??????.?###?? 8,5
.????#?##?.# 2,1,2,1
##.#???.???#?? 2,1,1,5
#.?##??#??#?????. 1,7,4,1
?.#????.?#???#?#?#? 1,2,10
???...??#??? 2,3
?.?????????#.??? 1,1,2,1,1
#?????.??# 1,4,2
#?#???????.?.##?#.# 9,1,4,1
#?#..?.???????#??#? 1,1,1,1,10
???##??#?..#? 5,2,1
???.??####????#? 2,12
.##???.?##?.? 2,1,3
?#..????#??##? 2,1,3,2
?#.????????.??..#? 1,2,1,2,1,2
?????##?#?. 1,1,5
??????????#????????? 2,10,2
??.??#.???????#??? 3,8
#?#??.?.????#??###? 1,3,1,1,7
?????.?#?????? 4,6
???????#??#????? 1,12
#?#???###.??#. 3,4,1
..??#????# 3,1
.?????###????????? 1,13
#??##.???.????. 5,2
??????.??? 1,3,1
??????????? 2,1,4
????????.? 6,1
?##..#??.??? 2,3,1,1
.#??..?#...?#. 1,2,1
??#??.???###?#??? 4,1,7,1
?.??????????#?? 2,7
.?????##?#?? 1,7
#?????#???.? 2,2,2,1
??.?##?#?#.????# 1,3,3,1,2
????.??#.???.##???? 4,1,1,6
?#???????#?#??#?. 2,4,6
?.?#??.??#? 3,1
?..????#???# 6,1
?????#??????????? 1,1,1,5,1
.?.?..??#????#.#? 1,7,2
?.????.????. 3,2
#??#??????.?????? 2,7,5
????#???????? 1,8
#??..?...??#??? 3,1,1,1,1
??#??#?#???????? 1,8,1
?..???.#???.?#?.?? 1,2,4,1,1
#??##??#???##?? 1,3,1,4,1
.??.??????????#??? 2,1,4,6
??#?#?..?##?#?#? 1,1,1,4,1
?????????????#??# 1,1,1,1,6
.?.???.?????.?? 1,1,1,1,2
?????#?.?.??#?#??. 7,2,1
????#??#?#.??.???? 7,1
??.???????? 1,4
?.?????????#? 8,1
.??#???????#?? 9,2
?#???????? 3,3,1
????.??#.?# 1,1,2
???.#?#?.??#???.? 3,2
#?.#??#???#????.? 1,1,6,1,1
..?#?#.#?? 4,2
?.??.??#?#?#???. 2,6
???????.???? 4,1
.???#?#???????# 8,4
????#??#???#.. 5,1
?????#?#???#? 4,1,1,2
.#??????#?#??## 2,1,1,5
??#??.?????????? 3,2,1,1,2
??.?.?#??##???#?# 1,1,5,2,1
#?..###??.?#??? 2,5,3
.??????????????#? 6,2,2,2
??????#??? 1,2,2
##?????????.??????. 8,1,3
????.#??.???..??##? 2,3,2,1,2
?.???#.??.. 4,1
???#????#?#.?#? 6,1,1,1
?#??????#????????? 3,1,3,2,1,1
.????..#?? 1,1,1
?????????#.?? 3,1
???#??#?#???. 5,1,1,1
???????#??#????##?? 1,1,1,4,4
#????????????##??? 7,4,2,1
?#??##?#??#?.# 2,5,2,1
#??..??????#?????#? 3,2,1,2,2
??#..?#?#.##????###? 3,3,2,4
?.??##?.???? 1,5,2
????.#..??????????? 1,2,1,3,5
?#???.#??????#???# 4,1,8,1
..##?..?????? 2,3
????..???..?#. 1,1
#.??#??#.???????? 1,2,1,5,1
???.?#?#?##?#???# 1,2,1,6,1
?#?.??##?????? 2,9
.???????.?.???#??? 1,1,1,1,1,4
.#???..??#?. 1,1,3
.?##????.???#? 3,2,2
....?#?##.? 5,1
?###??.#.?.?##??. 3,1,4
??.#???????#????#? 1,2,6,2,2
??#?.?????. 4,2
?#????????#.? 7,1,1
?.##??####????.#. 1,8,3,1
?.?????????.?? 1,2,5,2
?????..?###.? 4,4,1
???#?###??.?#?.?. 2,7,1,1
?.??.#?????.?.???.? 1,1,6,1,1,1
#????#?##????? 6,2,3
??#?#.?#????#.? 4,6
.???..??#? 1,3
??.#?????????.???# 1,1,2,3,1,1
.??.???????#. 2,1,1,3
???.#..?..????# 2,1,1,3
#????##?..# 1,6,1
###?????#.??## 3,5,2
?##?.?#???#????### 3,13
?#????#??#????.#.?? 4,4,1,1,1
?.?##???????.?#?.?#. 1,9,3,2
???#??.???? 6,2
#??.??.????#???#?? 2,1,2,3,1
??#??????#??#??????? 2,5,2,1,1,1
????#.????.?. 1,1,2,1
???#?#???.??. 3,2,1,1
#??#????.? 1,1,1
??#????#????.? 2,2
???#?#.?????? 3,1,2
#?.#?#???#.# 1,3,2,1
??#?.??#???? 1,6
????????#??.?.???? 8,2
????.???.????????? 1,1,1,1,9
?.?#??.??? 1,3,3
????###??##?###.? 1,12
?.#??.?##????.? 1,1,2,1,1
??#?#???..??#??? 6,3
?????#?#???#?#???#?? 15,1,1
?#????..?#???.???.?? 2,3,5,1,1,2
???????##??#???.##?? 11,2
?.#????##???.#.??#.? 10,1,2
?.?.?##????##?#?#? 1,1,3,1,7
????#?????????? 1,2,1,2,2
???????#?##????#?? 1,6,3
??????????#?# 1,1,1,3
#.??##????.?.??#???? 1,1,2,1,4,1
?###.?????????#? 4,2,2,1
???#???.##??? 1,2,4
###????#???#??### 8,7
.?#.#?#?##???#. 1,10
????????##..?#???#.? 8,5
?###?.??##.??#.? 4,1,2,3,1
???.??##??### 2,8
???.??..?.?.????#? 1,1,1,1,1,3
???#??##?..??.????? 7,2,1
#?.?????#????????? 1,1,1,4,2,1
?????..##?? 5,2,1
.?#???#.#????#??.?# 6,1,5,1
.#???..???? 4,1,1
?.?#???#?..??#??#??? 1,1,1,2,7,1
?#?????#???# 4,2,1,1
.???.???#?????????? 2,2,6,1,1
.?#???#?#? 4,4
???????..#.?#?.??#? 2,2,1,2,1,1
.??#?..?????? 1,5
###?????.??##???? 3,1,5
?????##..#??#. 7,4
???????#???.??## 1,1,4,4
.?#???.?????????. 3,1,1,1,3
??????????????#.? 6,2,3,1
?.?.????...?? 3,1
?.???????# 1,2,3
??.???..?#? 2,1
???#?#?????#. 8,1
?##??.???#.?????.? 4,3,1,3
??????????#?. 1,2,1,2
??..?#.?##???? 1,2,2,1
#???##?.#??.?## 3,2,1,1,3
??????##????.?.? 1,6,2,1,1
?????#?#????##. 6,4
?????#?.?#???# 1,3,6
??.?????.. 1,1,2
??.??????? 1,5
??????????.?.??##?? 5,1,1,1,6
???#???##.??#?#? 6,5
#??????###???.??? 1,7
??#?.????. 2,2
??#?????.??#.????. 6,1,1
.???#?#??????. 3,3
#?.???????#???? 1,2,4
?###???.?.??#??#.??. 7,1,2,2,1
?.?#?##??????#??.. 5,5
???#.???#???#?#??.# 3,10,1
#?????????#.? 6,1,1
?.###???#????#???#?? 12,3
???#?????##??? 4,5
#??????###??.#.? 2,1,4,1,1
??#????#???#???? 2,8
??#?#?????#? 3,1,2
??.#?#???.?#? 1,4,1,1
?#??#?##?? 1,5,1
?????..?????? 4,4,1
?.?#???.?##??#??? 1,4,6,1
#?#?????###.?.# 1,1,1,3,1
??###??????. 6,3
??.????#?#? 1,5
??##.??.??##.?.?? 4,1,1,2,1
?.#.??.#???.?#?##?? 1,1,2,7
?.???##?#?? 1,1,5
#??.#?#?#.????#?#??? 3,5,4
?#??????#?.??## 2,1,1,3
#.#..????????????# 1,1,1,2,2,2
.????###??..?#? 9,2
??.?##???? 1,2,1
?.???.?#.#?????##?? 3,2,4,4
???????#?#???#????? 1,1,1,12
?.#?????#.#?..#??.? 1,1,2,1,2,1
?.?..????.? 1,1
.#??#.???? 1,1,1
???#.????##???.???? 1,1,1,4,1,3
???????.??#? 1,4
???##..??? 1,3,1
.???.?.????#??#??? 2,1,4
?#??.???..??#??.???? 1,1,1,1,2,4
?????#????.#???? 5,2
#??.#?????.?#??? 3,1,1,4
??????????#??????.?? 9,2,1
.#????#.#???. 3,2,1,2
??#.???#?#?.? 1,5
???####?.?.??? 2,4,1,1
??.????..###??.. 1,4
??????.?????. 6,1,1
#???????.?.??.??#? 1,1,1,1,4
????#???..??????. 5,4
??..?????#?#?.?? 1,1,1,4,1
?#.#??#??#??? 1,2,7
#?#??.??#?.???? 1,2,1,1,1
.??##???????#??? 8,1,1,1
?.?.?????..????.? 1,2
.??...?##?#??? 1,4
?????????#?#?.?? 2,4,4,1
??????.??.??#.? 1,1,1,3,1
???????.#?#.???#?.? 1,3,1,3,1,3
.#??.???#? 1,1,2
.?#???..??.??##??. 3,4
#.?#?#??.???# 1,2,2,4
.?#??#???#??#?? 2,1,2,2
#.#?????.?.?#.??? 1,5,1,1,1
.#.????????#.??? 1,1,2,1,1
?##?#?????..#??????? 6,1,5,1
?????????#???#?#. 1,1,2,9
.?.???.#???. 1,1,1,1
??#?????##????#? 1,10,1
??.????#?#?#???? 2,1,10
.??..#??#? 1,1,1
?????#??????? 2,3,1,1
..?..?.???.#??.? 1,1,1,3,1
?#??#.?.###??#?? 5,1,7
??#???#???#?? 7,3
????????????. 2,5,3
.#.???.??? 1,1,1
???.?#??????.??????? 1,7,1,1,1
.#.???#??.?? 1,3,1
.????????.?#?#? 1,2,5
.?#??????.#? 6,2
.??.?#?????? 1,2,1,2
??#?#?##??????..???? 7,3,3
??.?.??#.#???##? 1,1,3,7
?.?#??.??#?#?. 1,5
?.????????#??..##. 8,2
????#??.??# 4,2
.??#?????#??????? 4,5,4
???????.???.??????#? 4,1,2,1,2
?.??.#?#??? 1,3,2
.#.??..#.??.???.#. 1,1,1,1,3,1
?...????.?#?#?????.. 4,5,2
#??..?.??#??????#?? 1,1,1,5,1,1
.?##??#????#??#.? 4,6,1
.#.???.#????.?.?#? 1,1,1,5,1,2
????#???.#?? 1,1,3
???????.??..??# 1,2,1,1,3
?#??.??##?? 1,1,6
.???????.??.? 1,2
.??????#??#?#?????. 10,1
.???#?????? 1,2,5
??#?#??.?.???.?? 5,1
.????#????#?.? 2,1,3
..#??.##?#?#?????? 2,10
??#?#???.? 2,2,1
.?##.?????.#.??? 3,1,1,1,1
.?###?????????..? 4,1,1,1,1
??????.?.? 6,1
.?##??.#??. 3,1,1
?.????#?.??.#??# 1,1,1,1,4
????.?#??.?#? 2,2,3
.??###?.#??? 6,1,1
..??#?#???????#????? 7,8
????.?#???##?#??. 1,1,6
???.?#????##. 2,8
?#?#?#.????????#? 6,8
?.????.?????#? 1,3,1
###?#?#.???#?.??#.. 5,1,2,1,1
??#.#?#.??????### 3,3,1,3
.????.??#??#???#?? 1,1,6,5
??????????????? 1,8
.???#?????????.?? 6,2,1,1
??????#?????#?#? 1,13
.?#???#??#?? 1,5
#??.?#??????????#? 2,4,7
???.#?#???.# 1,3,1,1
..?##?#??????. 4,2
#????.?.#????##?? 1,1,1,2,6
##???#??.???##?.??? 4,1,1,5,1,1
??##???#??? 8,1
??.#??.#?#. 2,2,3
??###???##??#??#??. 4,10
?.?#.????? 1,1,3
??.????#????# 1,4,1,1
???.?????##?#??????? 3,8,2`

let inputLines = input.split('\n').map(e => e.split(' '));

// console.log(input);

let cache = {};


let unfolded = unfoldInput(inputLines);
// console.log(input);

// run(unfolded);

// console.log(countSprings(".?.?????#?#?????#??.?.?????#?#?????#??.?.?????#?#?????#??.?.?????#?#?????#??.?.?????#?#?????#?" , [1,1,12,1,1,12,1,1,12,1,1,12,1,1,12]));
// console.log(countSprings(".?.?????#?#?????#?", [1,1,12]));

// console.log(countSprings("?????#?????????????????#?????????????????#?????????????????#?????????????????#???????????", [1,1,1,5,1,1,1,1,5,1,1,1,1,5,1,1,1,1,5,1,1,1,1,5,1]));
// console.log(countSprings("?????#???????????", [1,1,1,5,1]));

// console.log(countSprings("??#?#?????#????#?#?????#????#?#?????#????#?#?????#????#?#?????#?", [3,1,2,3,1,2,3,1,2,3,1,2,3,1,2]));
// console.log(countSprings("??#?#?????#?", [3,1,2]));

// console.log(countSprings("???????#?#???#?????????????#?#???#?????????????#?#???#?????????????#?#???#?????????????#?#???#?????", [1,1,1,12,1,1,1,12,1,1,1,12,1,1,1,12,1,1,1,12]));
// console.log(countSprings("???????#?#???#?????", [1,1,1,12]));

// console.log(countSprings("?????#?????????????????#?????????????????#?????????????????#?????????????????#???????????", [1,1,1,5,1,1,1,1,5,1,1,1,1,5,1,1,1,1,5,1,1,1,1,5,1]));
// console.log(countSprings("?????#???????????", [1,1,1,5,1]));

// console.log(cache);

function unfoldInput(inputLines) {
    for (let index = 0; index < inputLines.length; index++) {
        let line = inputLines[index];

        line[0] = Array(5).fill(line[0]).join('?'); 
        line[1] = Array(5).fill(line[1]).join(',');

        
    }

    return inputLines;

}


function run(input) {
    let counter = 0;
    for (let index = 0; index < input.length; index++) {


        const line = input[index];

        const springsLine = line[0];

        const groupNumbers = line[1].split(',').map(Number);

        // if (index == 409 || index == 723 ||  index == 879 ||  index == 896){
        //     console.log(line);
        // }

        let sum = countSprings(springsLine, groupNumbers);
        // console.log(sum)
        counter += sum;

        // EMPTY CACHE - Cache will get corrupt with too many keys
        cache = {}

        // console.log(index);
    
    }



    console.log("END");
    console.log(counter);
}



function countSprings(springsString, groupNumbers) {
    if (springsString.length === 0) {
        if (groupNumbers.length === 0) {
            return 1;
        }
        else {
            return 0;
        }
    }

    if (groupNumbers.length === 0) {
        if (springsString.includes('#')) {
            return 0;
        }
        else {
            return 1;
        }
    }

    let key = springsString + '--' + groupNumbers.join('');

    if (key in cache) {
        return cache[key];
    }

    let result = 0;

    if (['.', '?'].includes(springsString[0])) {
        let springsArray = springsString.split('');
        springsArray.shift();
        let newString = springsArray.join('');

        result += countSprings(newString, groupNumbers.slice());
    }

    if (['#', '?'].includes(springsString[0])) {
        if (groupNumbers[0] <= springsString.length && !checkBrokenSpring(springsString, groupNumbers) &&
            (groupNumbers[0] === springsString.length || springsString[groupNumbers[0]] !== '#')  ) {
                let sliced = sliceString(springsString, groupNumbers[0] + 1);

                let copyNums = groupNumbers.slice();
                copyNums.shift();

                result += countSprings(sliced, copyNums);
            }

    }

    cache[key] = result;

    return result;
}



function checkBrokenSpring(springsString, groupNumbers) {

    for (let index = 0; index < groupNumbers[0]; index++) {
        const char = springsString[index];

        if (char === '.') {
            return true;
        }
        
    }

    return false;

}


function sliceString(springsString, numToBeSliced) {

    let springArray = springsString.split('');

    for (let index = 0; index < numToBeSliced; index++) {
        springArray.shift();        
    }

    return springArray.join('');
}
